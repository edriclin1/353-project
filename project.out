SQL> /*
SQL> CIS 353 - Database Design Project
SQL> Edric Lin
SQL> Emilio Braun
SQL> Aaron Bager
SQL> */
SQL> --
SQL> DROP TABLE Member CASCADE CONSTRAINTS;

Table dropped.

SQL> DROP TABLE Employee CASCADE CONSTRAINTS;

Table dropped.

SQL> DROP TABLE Job CASCADE CONSTRAINTS;

Table dropped.

SQL> DROP TABLE Department CASCADE CONSTRAINTS;

Table dropped.

SQL> DROP TABLE Product CASCADE CONSTRAINTS;

Table dropped.

SQL> DROP TABLE Supplier CASCADE CONSTRAINTS;

Table dropped.

SQL> DROP TABLE Transaction CASCADE CONSTRAINTS;

Table dropped.

SQL> DROP TABLE MPhone CASCADE CONSTRAINTS;

Table dropped.

SQL> DROP TABLE EPhone CASCADE CONSTRAINTS;

Table dropped.

SQL> DROP TABLE Prod_Trans CASCADE CONSTRAINTS;

Table dropped.

SQL> --
SQL> CREATE TABLE Member
  2  (
  3  mID	     INTEGER,
  4  mFirst	     VARCHAR2(15)    NOT NULL,
  5  mLast	     VARCHAR2(15)    NOT NULL,
  6  mAddress	     VARCHAR2(30)    NOT NULL,
  7  mFee	     INTEGER	     NOT NULL,
  8  mType	     CHAR(1)	     NOT NULL,
  9  a_mID	     INTEGER,
 10  --
 11  CONSTRAINT mIC01 PRIMARY KEY (mid),
 12  CONSTRAINT mIC02 FOREIGN KEY (a_mID)
 13  	     REFERENCES Member(mID)
 14  	     ON DELETE SET NULL
 15  	     DEFERRABLE INITIALLY DEFERRED,
 16  CONSTRAINT mIC03 CHECK (mFee = 100 OR mFee = 80),
 17  CONSTRAINT mIC04 CHECK (mType = 'P' OR mType = 'A'),
 18  CONSTRAINT mIC05 CHECK (NOT (mType = 'P' AND NOT (mFee = 100))),
 19  CONSTRAINT mIC06 CHECK (NOT (mType = 'A' AND NOT (mFee = 80)))
 20  );

Table created.

SQL> --
SQL> CREATE TABLE Department
  2  (
  3  dID	     INTEGER,
  4  dName	     VARCHAR2(30)    NOT NULL,
  5  --
  6  CONSTRAINT dIC01 PRIMARY KEY (dID)
  7  );

Table created.

SQL> --
SQL> CREATE TABLE Job
  2  (
  3  jID	     INTEGER,
  4  jName	     VARCHAR2(30)    NOT NULL,
  5  j_dID	     INTEGER,
  6  --
  7  CONSTRAINT jIC01 PRIMARY KEY (jID),
  8  CONSTRAINT jIC02 FOREIGN KEY (j_dID)
  9  	     REFERENCES Department(dID)
 10  	     ON DELETE SET NULL
 11  	     DEFERRABLE INITIALLY DEFERRED
 12  );

Table created.

SQL> --
SQL> CREATE TABLE Employee
  2  (
  3  eID	     INTEGER,
  4  eFirst	     VARCHAR2(15)    NOT NULL,
  5  eLast	     VARCHAR2(15)    NOT NULL,
  6  eAddress	     VARCHAR2(30)    NOT NULL,
  7  eSalary	     INTEGER	     NOT NULL,
  8  s_eID	     INTEGER,
  9  e_jID	     INTEGER	     NOT NULL,
 10  --
 11  CONSTRAINT eIC01 PRIMARY KEY (eID),
 12  CONSTRAINT eIC02 FOREIGN KEY (s_eID)
 13  	     REFERENCES Employee(eID)
 14  	     ON DELETE SET NULL
 15  	     DEFERRABLE INITIALLY DEFERRED,
 16  CONSTRAINT eIC03 FOREIGN KEY (e_jID)
 17  	     REFERENCES Job(jID)
 18  	     ON DELETE CASCADE
 19  	     DEFERRABLE INITIALLY DEFERRED
 20  );

Table created.

SQL> --
SQL> CREATE TABLE Supplier
  2  (
  3  sID	     INTEGER,
  4  sName	     VARCHAR2(30)    NOT NULL,
  5  --
  6  CONSTRAINT sIC01 PRIMARY KEY (sid)
  7  );

Table created.

SQL> --
SQL> CREATE TABLE Product
  2  (
  3  pID	     INTEGER,
  4  pName	     VARCHAR2(30)    NOT NULL,
  5  pInventory      INTEGER	     NOT NULL,
  6  pPrice	     NUMBER(6,2)     NOT NULL,
  7  p_dID	     INTEGER	     NOT NULL,
  8  p_sID	     INTEGER	     NOT NULL,
  9  sDate	     DATE	     NOT NULL,
 10  --
 11  CONSTRAINT pIC01 PRIMARY KEY (pID),
 12  CONSTRAINT pIC02 FOREIGN KEY (p_dID)
 13  	     REFERENCES Department(dID)
 14  	     ON DELETE CASCADE
 15  	     DEFERRABLE INITIALLY DEFERRED,
 16  CONSTRAINT pIC03 FOREIGN KEY (p_sID)
 17  	     REFERENCES Supplier(sID)
 18  	     ON DELETE CASCADE
 19  	     DEFERRABLE INITIALLY DEFERRED
 20  );

Table created.

SQL> --
SQL> CREATE TABLE Transaction
  2  (
  3  t_mID	     INTEGER,
  4  tTimestamp      CHAR(17)	     NOT NULL,
  5  tTotal	     NUMBER(7,2)     NOT NULL,
  6  --
  7  CONSTRAINT tIC01 PRIMARY KEY (t_mID, tTimestamp),
  8  CONSTRAINT tIC02 FOREIGN KEY (t_mID)
  9  	     REFERENCES Member(mID)
 10  	     ON DELETE CASCADE
 11  	     DEFERRABLE INITIALLY DEFERRED,
 12  CONSTRAINT tIC03 CHECK (tTimestamp LIKE '__/__/__ __:__:__')
 13  );

Table created.

SQL> --
SQL> CREATE TABLE MPhone
  2  (
  3  m_mID	     INTEGER,
  4  mPhone	     CHAR(14),
  5  --
  6  CONSTRAINT mpIC01 PRIMARY KEY (m_mID, mPhone),
  7  CONSTRAINT mpIC02 FOREIGN KEY (m_mID)
  8  	     REFERENCES Member(mID)
  9  	     ON DELETE CASCADE
 10  	     DEFERRABLE INITIALLY DEFERRED,
 11  CONSTRAINT mpIC03 CHECK (mPhone LIKE '(___)-___-____')
 12  );

Table created.

SQL> --
SQL> CREATE TABLE EPhone
  2  (
  3  e_mID	     INTEGER,
  4  ePhone	     CHAR(14),
  5  --
  6  CONSTRAINT epIC01 PRIMARY KEY (e_mID, ePhone),
  7  CONSTRAINT epIC02 FOREIGN KEY (e_mID)
  8  	     REFERENCES Member(mID)
  9  	     ON DELETE CASCADE
 10  	     DEFERRABLE INITIALLY DEFERRED,
 11  CONSTRAINT epIC03 CHECK (ePhone LIKE '(___)-___-____')
 12  );

Table created.

SQL> --
SQL> CREATE TABLE Prod_Trans
  2  (
  3  pt_mID	     INTEGER,
  4  pt_tTimestamp   CHAR(17),
  5  pt_pID	     INTEGER,
  6  --
  7  CONSTRAINT ptIC01 PRIMARY KEY (pt_mID, pt_tTimestamp, pt_pID),
  8  CONSTRAINT ptIC02 FOREIGN KEY (pt_mID, pt_tTimestamp)
  9  	     REFERENCES Transaction(t_mID, tTimestamp)
 10  	     ON DELETE CASCADE
 11  	     DEFERRABLE INITIALLY DEFERRED,
 12  CONSTRAINT ptIC03 FOREIGN KEY (pt_pID)
 13  	     REFERENCES Product(pID)
 14  	     ON DELETE CASCADE
 15  	     DEFERRABLE INITIALLY DEFERRED
 16  );

Table created.

SQL> --
SQL> SET FEEDBACK OFF
SQL> --
SQL> INSERT INTO Member VALUES ('10', 'John', 'Smith', '100 address', 100, 'P', 14);
SQL> INSERT INTO Member VALUES ('11', 'Logan', 'Gardner', '110 address', 100, 'P', 12);
SQL> INSERT INTO Member VALUES ('12', 'Carl', 'Wheeler', '120 address', 80, 'A', NULL);
SQL> INSERT INTO Member VALUES ('13', 'Jones', 'Vikema', '130 address', 100, 'P', NULL);
SQL> INSERT INTO Member VALUES ('14', 'Gordon', 'Freddrick', '140 address', 80, 'A', NULL);
SQL> INSERT INTO Member VALUES ('15', 'Charlie', 'Jones', '150 address', 100, 'P', NULL);
SQL> 
SQL> --
SQL> INSERT INTO Department VALUES ('10', 'Salesfloor');
SQL> INSERT INTO Department VALUES ('11', 'Checkout');
SQL> INSERT INTO Department VALUES ('12', 'Photo');
SQL> INSERT INTO Department VALUES ('13', 'Food');
SQL> INSERT INTO Department VALUES ('14', 'Pharmacy');
SQL> --
SQL> INSERT INTO Job VALUES ('10', 'Cashier', '11');
SQL> INSERT INTO Job VALUES ('11', 'Chef', '13');
SQL> INSERT INTO Job VALUES ('12', 'Sales Associate', '10');
SQL> INSERT INTO Job VALUES ('13', 'Photographer', '12');
SQL> INSERT INTO Job VALUES ('14', 'Pharmacist', '14');
SQL> --
SQL> INSERT INTO Employee VALUES ('10', 'Jane', 'Smith', '100 address', '25000', '11', '10');
SQL> INSERT INTO Employee VALUES ('11', 'Jill', 'Howard', '110 address', '30000', NULL, '13');
SQL> INSERT INTO Employee VALUES ('12', 'Dave', 'Tillman', '120 address', '40000', NULL, '11');
SQL> INSERT INTO Employee VALUES ('13', 'Mary', 'Freeman', '130 address', '55000', NULL, '14');
SQL> INSERT INTO Employee VALUES ('14', 'Holly', 'North', '100 address', '30000', '10', '12');
SQL> --
SQL> INSERT INTO Supplier VALUES ('10', 'Gordons Food Service');
SQL> INSERT INTO Supplier VALUES ('11', 'Meijers');
SQL> INSERT INTO Supplier VALUES ('12', 'Best Buy');
SQL> INSERT INTO Supplier VALUES ('13', 'Sparrow Health');
SQL> INSERT INTO Supplier VALUES ('14', 'BnH Photo Video');
SQL> --
SQL> INSERT INTO Product VALUES ('10', 'Charmins Toilet Paper', 100, 5.00, '10', '11', TO_DATE('10/10/18', 'MM/DD/YY'));
SQL> INSERT INTO Product VALUES ('11', 'Ramon Noodle Soup', 50, 2.00, '10', '10', TO_DATE('10/10/18', 'MM/DD/YY'));
SQL> INSERT INTO Product VALUES ('12', 'Light Bulbs (4 pck.)', 40, 10.00, '10', '11', TO_DATE('10/10/18', 'MM/DD/YY'));
SQL> INSERT INTO Product VALUES ('13', 'Asus Laptop', 20, 500.00, '10', '12', TO_DATE('10/10/18', 'MM/DD/YY'));
SQL> INSERT INTO Product VALUES ('14', 'Fresh Chicken Roast', 30, 5.00, '13', '10', TO_DATE('10/10/18', 'MM/DD/YY'));
SQL> INSERT INTO Product VALUES ('15', 'Light Bulbs (4 pck.)', 40, 10.00, '10', '11', TO_DATE('10/10/18', 'MM/DD/YY'));
SQL> --
SQL> INSERT INTO Transaction VALUES ('10', '10/12/18 08:12:50', 10);
SQL> INSERT INTO Transaction VALUES ('11', '10/12/18 09:00:21', 40);
SQL> INSERT INTO Transaction VALUES ('12', '10/12/18 10:14:03', 20);
SQL> INSERT INTO Transaction VALUES ('13', '10/12/18 10:53:42', 15);
SQL> INSERT INTO Transaction VALUES ('14', '10/12/18 12:38:12', 5);
SQL> --
SQL> INSERT INTO MPhone VALUES ('10', '(616)-100-1212');
SQL> INSERT INTO MPhone VALUES ('11', '(616)-110-1212');
SQL> INSERT INTO MPhone VALUES ('12', '(616)-120-1212');
SQL> INSERT INTO MPhone VALUES ('13', '(616)-130-1212');
SQL> INSERT INTO MPhone VALUES ('14', '(616)-140-1212');
SQL> --
SQL> INSERT INTO EPhone VALUES ('10', '(616)-000-0000');
SQL> INSERT INTO EPhone VALUES ('11', '(616)-001-0101');
SQL> INSERT INTO EPhone VALUES ('12', '(616)-002-0202');
SQL> INSERT INTO EPhone VALUES ('13', '(616)-003-0303');
SQL> INSERT INTO EPhone VALUES ('14', '(616)-004-0404');
SQL> --
SQL> INSERT INTO Prod_Trans VALUES ('10', '10/12/18 08:12:50', '10');
SQL> INSERT INTO Prod_Trans VALUES ('10', '10/12/18 08:12:50', '11');
SQL> INSERT INTO Prod_Trans VALUES ('10', '10/12/18 08:12:50', '12');
SQL> INSERT INTO Prod_Trans VALUES ('11', '10/12/18 09:00:21', '11');
SQL> INSERT INTO Prod_Trans VALUES ('12', '10/12/18 10:14:03', '12');
SQL> INSERT INTO Prod_Trans VALUES ('13', '10/12/18 10:53:42', '13');
SQL> INSERT INTO Prod_Trans VALUES ('14', '10/12/18 12:38:12', '14');
SQL> --
SQL> SET FEEDBACK ON
SQL> COMMIT;

Commit complete.

SQL> --
SQL> SELECT * FROM Member;

       MID MFIRST          MLAST           MADDRESS                             
---------- --------------- --------------- ------------------------------       
      MFEE M      A_MID                                                         
---------- - ----------                                                         
        10 John            Smith           100 address                          
       100 P         14                                                         
                                                                                
        11 Logan           Gardner         110 address                          
       100 P         12                                                         
                                                                                
        12 Carl            Wheeler         120 address                          
        80 A                                                                    
                                                                                

       MID MFIRST          MLAST           MADDRESS                             
---------- --------------- --------------- ------------------------------       
      MFEE M      A_MID                                                         
---------- - ----------                                                         
        13 Jones           Vikema          130 address                          
       100 P                                                                    
                                                                                
        14 Gordon          Freddrick       140 address                          
        80 A                                                                    
                                                                                
        15 Charlie         Jones           150 address                          
       100 P                                                                    
                                                                                

6 rows selected.

SQL> SELECT * FROM Department;

       DID DNAME                                                                
---------- ------------------------------                                       
        10 Salesfloor                                                           
        11 Checkout                                                             
        12 Photo                                                                
        13 Food                                                                 
        14 Pharmacy                                                             

5 rows selected.

SQL> SELECT * FROM Job;

       JID JNAME                               J_DID                            
---------- ------------------------------ ----------                            
        10 Cashier                                11                            
        11 Chef                                   13                            
        12 Sales Associate                        10                            
        13 Photographer                           12                            
        14 Pharmacist                             14                            

5 rows selected.

SQL> SELECT * FROM Employee;

       EID EFIRST          ELAST           EADDRESS                             
---------- --------------- --------------- ------------------------------       
   ESALARY      S_EID      E_JID                                                
---------- ---------- ----------                                                
        10 Jane            Smith           100 address                          
     25000         11         10                                                
                                                                                
        11 Jill            Howard          110 address                          
     30000                    13                                                
                                                                                
        12 Dave            Tillman         120 address                          
     40000                    11                                                
                                                                                

       EID EFIRST          ELAST           EADDRESS                             
---------- --------------- --------------- ------------------------------       
   ESALARY      S_EID      E_JID                                                
---------- ---------- ----------                                                
        13 Mary            Freeman         130 address                          
     55000                    14                                                
                                                                                
        14 Holly           North           100 address                          
     30000         10         12                                                
                                                                                

5 rows selected.

SQL> SELECT * FROM Supplier;

       SID SNAME                                                                
---------- ------------------------------                                       
        10 Gordons Food Service                                                 
        11 Meijers                                                              
        12 Best Buy                                                             
        13 Sparrow Health                                                       
        14 BnH Photo Video                                                      

5 rows selected.

SQL> SELECT * FROM Product;

       PID PNAME                          PINVENTORY     PPRICE      P_DID      
---------- ------------------------------ ---------- ---------- ----------      
     P_SID SDATE                                                                
---------- ---------                                                            
        10 Charmins Toilet Paper                 100          5         10      
        11 10-OCT-18                                                            
                                                                                
        11 Ramon Noodle Soup                      50          2         10      
        10 10-OCT-18                                                            
                                                                                
        12 Light Bulbs (4 pck.)                   40         10         10      
        11 10-OCT-18                                                            
                                                                                

       PID PNAME                          PINVENTORY     PPRICE      P_DID      
---------- ------------------------------ ---------- ---------- ----------      
     P_SID SDATE                                                                
---------- ---------                                                            
        13 Asus Laptop                            20        500         10      
        12 10-OCT-18                                                            
                                                                                
        14 Fresh Chicken Roast                    30          5         13      
        10 10-OCT-18                                                            
                                                                                
        15 Light Bulbs (4 pck.)                   40         10         10      
        11 10-OCT-18                                                            
                                                                                

6 rows selected.

SQL> SELECT * FROM Transaction;

     T_MID TTIMESTAMP            TTOTAL                                         
---------- ----------------- ----------                                         
        10 10/12/18 08:12:50         10                                         
        11 10/12/18 09:00:21         40                                         
        12 10/12/18 10:14:03         20                                         
        13 10/12/18 10:53:42         15                                         
        14 10/12/18 12:38:12          5                                         

5 rows selected.

SQL> SELECT * FROM MPhone;

     M_MID MPHONE                                                               
---------- --------------                                                       
        10 (616)-100-1212                                                       
        11 (616)-110-1212                                                       
        12 (616)-120-1212                                                       
        13 (616)-130-1212                                                       
        14 (616)-140-1212                                                       

5 rows selected.

SQL> SELECT * FROM EPhone;

     E_MID EPHONE                                                               
---------- --------------                                                       
        10 (616)-000-0000                                                       
        11 (616)-001-0101                                                       
        12 (616)-002-0202                                                       
        13 (616)-003-0303                                                       
        14 (616)-004-0404                                                       

5 rows selected.

SQL> SELECT * FROM Prod_Trans;

    PT_MID PT_TTIMESTAMP         PT_PID                                         
---------- ----------------- ----------                                         
        10 10/12/18 08:12:50         10                                         
        10 10/12/18 08:12:50         11                                         
        10 10/12/18 08:12:50         12                                         
        11 10/12/18 09:00:21         11                                         
        12 10/12/18 10:14:03         12                                         
        13 10/12/18 10:53:42         13                                         
        14 10/12/18 12:38:12         14                                         

7 rows selected.

SQL> --
SQL> /*(Q01) Query joining 4 relations.
SQL> For every employee who works a job that is a part of a department that sells 'Ramon Noodle Soup':
SQL> Find the employees eID and eLast.
SQL> */
SQL> SELECT E.eID, E.eLast
  2  FROM Employee E, Job J, Department D, Product P
  3  WHERE E.e_jID = J.jID AND
  4  	   J.j_dID = D.dID AND
  5  	   D.dID = P.p_dID AND
  6  	   P.pName = 'Ramon Noodle Soup'
  7  ORDER BY E.eLast;

       EID ELAST                                                                
---------- ---------------                                                      
        14 North                                                                

1 row selected.

SQL> --
SQL> --
SQL> /*(Q02) SELF-JOIN query.
SQL> For every employee who has a salary that is different than their supervisor's salary:
SQL> Find the employee's eID, eLast, and the eID of their supervisor.
SQL> */
SQL> SELECT E1.eID, E1.eLast, E1.s_eID
  2  FROM Employee E1, Employee E2
  3  WHERE E1.s_eID IS NOT NULL AND
  4  	   E1.s_eID = E2.eID AND
  5  	   E1.eSalary <> E2.eSalary
  6  ORDER BY E1.eLast;

       EID ELAST                S_EID                                           
---------- --------------- ----------                                           
        14 North                   10                                           
        10 Smith                   11                                           

2 rows selected.

SQL> --
SQL> --
SQL> /*(Q03) INTERSECT query.
SQL> For every employee who has a supervisor and works for the Salesfloor department:
SQL> Find the employee's eID, eLast.
SQL> */
SQL> SELECT eID, eLast
  2  FROM Employee
  3  WHERE s_eID IS NOT NULL
  4  INTERSECT
  5  SELECT eID, eLast
  6  FROM Employee E, Job J, Department D
  7  WHERE E.e_jID = J.jID AND
  8  	   J.j_dID = D.dID AND
  9  	   D.dName LIKE 'Salesfloor';

       EID ELAST                                                                
---------- ---------------                                                      
        14 North                                                                

1 row selected.

SQL> --
SQL> --
SQL> /*(Q04) MAX query.
SQL> Find the max salary of all employees.
SQL> */
SQL> SELECT MAX(eSalary)
  2  FROM Employee;

MAX(ESALARY)                                                                    
------------                                                                    
       55000                                                                    

1 row selected.

SQL> --
SQL> --
SQL> /*(Q05) GROUP BY, HAVING, ORDER BY in the same query.
SQL> Find the mID and mFirst of members who have purchased more than two products.
SQL> */
SQL> SELECT M.mID, M.mFirst
  2  FROM   Member M, Prod_Trans PT
  3  WHERE  M.mID = PT.pt_mID
  4  GROUP BY M.mID, M.mFirst
  5  HAVING COUNT(*) > 2;

       MID MFIRST                                                               
---------- ---------------                                                      
        10 John                                                                 

1 row selected.

SQL> --
SQL> --
SQL> /*(Q06) Correlated subquery
SQL> Find the mID and mFirst of primary members who have not purchased any products.
SQL> */
SQL> SELECT M.mID, M.mFirst
  2  FROM   Member M
  3  WHERE  M.mType = 'P' AND
  4  	    NOT EXISTS (SELECT *
  5  			FROM Prod_Trans PT
  6  			WHERE PT.pt_mID = M.mID);

       MID MFIRST                                                               
---------- ---------------                                                      
        15 Charlie                                                              

1 row selected.

SQL> --
SQL> --
SQL> /*(Q07) Non-correlated subquery
SQL> Find the mID and mFirst of primary members who have not purchased any products.
SQL> */
SQL> SELECT M.mID, M.mFirst
  2  FROM   Member M
  3  WHERE  M.mType = 'P' AND
  4  	    M.mID NOT IN (SELECT PT.pt_mID
  5  			  FROM Prod_Trans PT);

       MID MFIRST                                                               
---------- ---------------                                                      
        15 Charlie                                                              

1 row selected.

SQL> --
SQL> --
SQL> /*(Q08) Relational DIVISION Query
SQL> Find the mID and mFirst of every member who has purchased every product named 'Light Bulbs (4 pck.)'.
SQL> */
SQL> SELECT M.mID, M.mFirst
  2  FROM   Member M
  3  WHERE NOT EXISTS ((SELECT P.pID
  4  			FROM  Product P
  5  			WHERE P.pName= 'Light Bulbs (4 pck.)')
  6  			MINUS
  7  		       (SELECT P.pID
  8  			FROM   Prod_Trans PT, Product P
  9  			WHERE  PT.pt_mID = m.mID AND
 10  			       PT.pt_pID = P.pID AND
 11  			       P.pName = 'Light Bulbs (4 pck.)'));

no rows selected

SQL> --
SQL> --
SQL> /*(Q09) Outer Join Query
SQL> Find the mID, mFirst of every member. Also show transactions for those who have them.
SQL> */
SQL> SELECT M.mID, M.mFirst, T.tTimestamp, T.tTotal
  2  FROM Member M LEFT OUTER JOIN Transaction T ON M.mID = T.t_mID;

       MID MFIRST          TTIMESTAMP            TTOTAL                         
---------- --------------- ----------------- ----------                         
        10 John            10/12/18 08:12:50         10                         
        11 Logan           10/12/18 09:00:21         40                         
        12 Carl            10/12/18 10:14:03         20                         
        13 Jones           10/12/18 10:53:42         15                         
        14 Gordon          10/12/18 12:38:12          5                         
        15 Charlie                                                              

6 rows selected.

SQL> --
SQL> --
SQL> /*(Q10) RANK Query
SQL> Find the rank of the salary 30000 among all salaries.
SQL> */
SQL> SELECT RANK(40000) WITHIN GROUP
  2  	   (ORDER BY E.eSalary) "Rank of 30000"
  3  FROM Employee E;

Rank of 30000                                                                   
-------------                                                                   
            4                                                                   

1 row selected.

SQL> --
SQL> --
SQL> /*(Q11) Top-N Query
SQL> For every employee whose salary is equal to one of the two lowest salaries, Find the eID, eLast, and eSalary.
SQL> */
SQL> SELECT E.eID, E.eLast, E.eSalary
  2  FROM   EMPLOYEE E
  3  WHERE  E.eSalary IN (SELECT *
  4  			 FROM (SELECT DISTINCT E.eSalary
  5  			       FROM Employee E
  6  			       ORDER BY E.eSalary)
  7  			       WHERE ROWNUM < 3);

       EID ELAST              ESALARY                                           
---------- --------------- ----------                                           
        10 Smith                25000                                           
        11 Howard               30000                                           
        14 North                30000                                           

3 rows selected.

SQL> --
SQL> -- Testing: mIC01 (accept 1111 named Aaa)
SQL> INSERT INTO Member VALUES (null, 'Aaa', 'Aaa', '123 4th Street', 100, 'P', null);
INSERT INTO Member VALUES (null, 'Aaa', 'Aaa', '123 4th Street', 100, 'P', null)
                           *
ERROR at line 1:
ORA-01400: cannot insert NULL into ("LINE"."MEMBER"."MID") 


SQL> INSERT INTO Member VALUES (1111, 'Aaa', 'Aaa', '123 4th Street', 100, 'P', null);

1 row created.

SQL> INSERT INTO Member VALUES (1111, 'Bbb', 'Bbb', '123 4th Street', 100, 'P', null);
INSERT INTO Member VALUES (1111, 'Bbb', 'Bbb', '123 4th Street', 100, 'P', null)
*
ERROR at line 1:
ORA-00001: unique constraint (LINE.MIC01) violated 


SQL> --
SQL> -- Testing: eIC02 (accept 2222 with null supervisor)
SQL> INSERT INTO Department VALUES (9999, 'Department');

1 row created.

SQL> INSERT INTO Job VALUES (9999, 'Job', 9999);

1 row created.

SQL> INSERT INTO Employee VALUES (2221, 'Ccc', 'Ccc', '123 4th Street', 10000, 2222, 9999);

1 row created.

SQL> INSERT INTO Employee VALUES (2222, 'Ddd', 'Ddd', '123 4th Street', 10000, null, 9999);

1 row created.

SQL> DELETE FROM Employee WHERE eID = 2222;

1 row deleted.

SQL> --
SQL> -- Testing: mIC03 (accept 3331, 3332)
SQL> INSERT INTO Member VALUES (3330, 'Ccc', 'Ccc', '123 4th Street', 50, 'P', 321);
INSERT INTO Member VALUES (3330, 'Ccc', 'Ccc', '123 4th Street', 50, 'P', 321)
*
ERROR at line 1:
ORA-02290: check constraint (LINE.MIC05) violated 


SQL> INSERT INTO Member VALUES (3331, 'Ccc', 'Ccc', '123 4th Street', 100, 'P', null);

1 row created.

SQL> INSERT INTO Member VALUES (3332, 'Ccc', 'Ccc', '123 4th Street', 80, 'A', null);

1 row created.

SQL> --
SQL> -- Testing: mIC04 (accept 4441, 4442)
SQL> INSERT INTO Member VALUES (4440, 'Fff', 'Fff', '123 4th Street', 100, 'Z', null);
INSERT INTO Member VALUES (4440, 'Fff', 'Fff', '123 4th Street', 100, 'Z', null)
*
ERROR at line 1:
ORA-02290: check constraint (LINE.MIC04) violated 


SQL> INSERT INTO Member VALUES (4441, 'Fff', 'Fff', '123 4th Street', 80, 'A', null);

1 row created.

SQL> INSERT INTO Member VALUES (4442, 'Fff', 'Fff', '123 4th Street', 100, 'P', null);

1 row created.

SQL> --
SQL> -- Testing: mIC05, mIC06 (accept 5552, 5553)
SQL> INSERT INTO Member VALUES (5550, 'Ggg', 'Ggg', '123 4th Street', 100, 'A', null);
INSERT INTO Member VALUES (5550, 'Ggg', 'Ggg', '123 4th Street', 100, 'A', null)
*
ERROR at line 1:
ORA-02290: check constraint (LINE.MIC06) violated 


SQL> INSERT INTO Member VALUES (5551, 'Ggg', 'Ggg', '123 4th Street', 80, 'P', null);
INSERT INTO Member VALUES (5551, 'Ggg', 'Ggg', '123 4th Street', 80, 'P', null)
*
ERROR at line 1:
ORA-02290: check constraint (LINE.MIC05) violated 


SQL> INSERT INTO Member VALUES (5552, 'Ggg', 'Ggg', '123 4th Street', 80, 'A', null);

1 row created.

SQL> INSERT INTO Member VALUES (5553, 'Ggg', 'Ggg', '123 4th Street', 100, 'P', null);

1 row created.

SQL> --
SQL> COMMIT;

Commit complete.

SQL> --
SQL> SELECT * FROM Member;

       MID MFIRST          MLAST           MADDRESS                             
---------- --------------- --------------- ------------------------------       
      MFEE M      A_MID                                                         
---------- - ----------                                                         
        10 John            Smith           100 address                          
       100 P         14                                                         
                                                                                
        11 Logan           Gardner         110 address                          
       100 P         12                                                         
                                                                                
        12 Carl            Wheeler         120 address                          
        80 A                                                                    
                                                                                

       MID MFIRST          MLAST           MADDRESS                             
---------- --------------- --------------- ------------------------------       
      MFEE M      A_MID                                                         
---------- - ----------                                                         
        13 Jones           Vikema          130 address                          
       100 P                                                                    
                                                                                
        14 Gordon          Freddrick       140 address                          
        80 A                                                                    
                                                                                
        15 Charlie         Jones           150 address                          
       100 P                                                                    
                                                                                

       MID MFIRST          MLAST           MADDRESS                             
---------- --------------- --------------- ------------------------------       
      MFEE M      A_MID                                                         
---------- - ----------                                                         
      1111 Aaa             Aaa             123 4th Street                       
       100 P                                                                    
                                                                                
      3331 Ccc             Ccc             123 4th Street                       
       100 P                                                                    
                                                                                
      3332 Ccc             Ccc             123 4th Street                       
        80 A                                                                    
                                                                                

       MID MFIRST          MLAST           MADDRESS                             
---------- --------------- --------------- ------------------------------       
      MFEE M      A_MID                                                         
---------- - ----------                                                         
      4441 Fff             Fff             123 4th Street                       
        80 A                                                                    
                                                                                
      4442 Fff             Fff             123 4th Street                       
       100 P                                                                    
                                                                                
      5552 Ggg             Ggg             123 4th Street                       
        80 A                                                                    
                                                                                

       MID MFIRST          MLAST           MADDRESS                             
---------- --------------- --------------- ------------------------------       
      MFEE M      A_MID                                                         
---------- - ----------                                                         
      5553 Ggg             Ggg             123 4th Street                       
       100 P                                                                    
                                                                                

13 rows selected.

SQL> SELECT * FROM Employee;

       EID EFIRST          ELAST           EADDRESS                             
---------- --------------- --------------- ------------------------------       
   ESALARY      S_EID      E_JID                                                
---------- ---------- ----------                                                
        10 Jane            Smith           100 address                          
     25000         11         10                                                
                                                                                
        11 Jill            Howard          110 address                          
     30000                    13                                                
                                                                                
        12 Dave            Tillman         120 address                          
     40000                    11                                                
                                                                                

       EID EFIRST          ELAST           EADDRESS                             
---------- --------------- --------------- ------------------------------       
   ESALARY      S_EID      E_JID                                                
---------- ---------- ----------                                                
        13 Mary            Freeman         130 address                          
     55000                    14                                                
                                                                                
        14 Holly           North           100 address                          
     30000         10         12                                                
                                                                                
      2221 Ccc             Ccc             123 4th Street                       
     10000                  9999                                                
                                                                                

6 rows selected.

SQL> SELECT * FROM Product;

       PID PNAME                          PINVENTORY     PPRICE      P_DID      
---------- ------------------------------ ---------- ---------- ----------      
     P_SID SDATE                                                                
---------- ---------                                                            
        10 Charmins Toilet Paper                 100          5         10      
        11 10-OCT-18                                                            
                                                                                
        11 Ramon Noodle Soup                      50          2         10      
        10 10-OCT-18                                                            
                                                                                
        12 Light Bulbs (4 pck.)                   40         10         10      
        11 10-OCT-18                                                            
                                                                                

       PID PNAME                          PINVENTORY     PPRICE      P_DID      
---------- ------------------------------ ---------- ---------- ----------      
     P_SID SDATE                                                                
---------- ---------                                                            
        13 Asus Laptop                            20        500         10      
        12 10-OCT-18                                                            
                                                                                
        14 Fresh Chicken Roast                    30          5         13      
        10 10-OCT-18                                                            
                                                                                
        15 Light Bulbs (4 pck.)                   40         10         10      
        11 10-OCT-18                                                            
                                                                                

6 rows selected.

SQL> SELECT * FROM Transaction;

     T_MID TTIMESTAMP            TTOTAL                                         
---------- ----------------- ----------                                         
        10 10/12/18 08:12:50         10                                         
        11 10/12/18 09:00:21         40                                         
        12 10/12/18 10:14:03         20                                         
        13 10/12/18 10:53:42         15                                         
        14 10/12/18 12:38:12          5                                         

5 rows selected.

SQL> SELECT * FROM MPhone;

     M_MID MPHONE                                                               
---------- --------------                                                       
        10 (616)-100-1212                                                       
        11 (616)-110-1212                                                       
        12 (616)-120-1212                                                       
        13 (616)-130-1212                                                       
        14 (616)-140-1212                                                       

5 rows selected.

SQL> --
SQL> SPOOL OFF
